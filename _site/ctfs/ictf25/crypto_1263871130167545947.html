<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CTFdi</title>
  <style>
    :root {
        --primary: #ff2e63;   /* neon red/pink */
        --secondary: #162447;
        --accent: #08d9d6;    /* neon blue/cyan */
        --background: #0a0a0f;
        --surface: rgba(20, 20, 40, 0.9);
        --text: #e6f1ff;
    }

    body {
        font-family: 'Press Start 2P', monospace;
        background-color: var(--background);
        color: var(--text);
        margin: 0;
        padding: 20px;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        align-items: center;
        font-size: 14px; /* bigger font */
    }

    .chat {
        width: 100%;
        max-width: 800px;
        height: 500px;
        overflow-y: auto;
        background: var(--surface);
        border-radius: 8px;
        box-shadow: 0 0 25px rgba(255, 46, 99, 0.3);
        padding: 12px;
        display: flex;
        flex-direction: column-reverse;
    }

    .message {
        margin: 12px 0;
        padding: 10px;
        border-radius: 6px;
        background: rgba(15, 15, 25, 0.85);
        box-shadow: 0 0 6px rgba(8, 217, 214, 0.3);
        font-size: 14px;
        line-height: 1.5;
    }

    .timestamp {
        font-size: 11px;
        color: var(--primary); /* red timestamps */
        margin-bottom: 4px;
        display: block;
        opacity: 0.55;
    }

    #summary {
        width: 100%;
        max-width: 800px;
        margin: 30px auto;
        padding: 20px;
        background: var(--surface);
        line-height: 1.6;
        border-radius: 8px;
        box-shadow: 0 0 20px rgba(8, 217, 214, 0.3);
        font-size: 14px;
    }

    .content a {
        color: var(--accent); /* blue links */
        text-decoration: none;
        font-weight: bold;
    }

    .content a:hover {
        opacity: 0.8;
        text-decoration: underline;
    }

    /* CRT scanline effect */
    .scanline {
        background: linear-gradient(to bottom,
            rgba(255, 255, 255, 0) 0%,
            rgba(255, 255, 255, 0.05) 10%,
            rgba(255, 255, 255, 0) 100%);
        animation: scanline 8s linear infinite;
        pointer-events: none;
    }

    @keyframes scanline {
        0% { transform: translateY(-100%); }
        100% { transform: translateY(100%); }
    }
</style>
</head>
<body>
  <h1>Channel: [data/ctfs/ictf25/crypto_1263871130167545947.json]</h1>
  <h3>Writeup Chat</h3>
  <div id="chat" class="chat">
    <div class="message">
      <span class="timestamp">2025-09-13T06:15:56.902000+00:00</span>
      <div class="content"><a href="https://nostarch.com/serious-cryptography-2nd-edition" target="_blank">https://nostarch.com/serious-cryptography-2nd-edition</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2025-09-07T21:36:15.828000+00:00</span>
      <div class="content">u can read the chat. A normal PACD lattice works:
```python
    M = block_matrix([
        [1, zero_vector(t).row()],
        [vector(x).column(), identity_matrix(t)*m]
    ]).T.LLL()
```
and i found this lattice in a paper earlier but only glossed over it during the competition &lt;:deadge:1011247250917310555&gt; 
```py
# <a href="https://eprint.iacr.org/2024/1125.pdf" target="_blank">https://eprint.iacr.org/2024/1125.pdf</a>
# Improved SDA lattice for ACD-CRT
def AGCD(x, N, rho): 
    t = len(x)
    M = block_matrix([
        [2^rho, vector(x).row()],
        [zero_vector(t).column(), identity_matrix(t)*N]
    ]).LLL()
    for r in M.rows():
        g = gcd(abs(r[0]), N)
        if 1 &lt; g &lt; N:
            return N//g
```
it returns a semiprime, but you can do two calls to split it
```python
mg = AGCD(nums, m, rho)
p1 = AGCD(nums,mg, rho)
p2 = mg // p1
```
then reduce m for next iteration</div>
    </div>
    <div class="message">
      <span class="timestamp">2025-09-07T20:05:57.798000+00:00</span>
      <div class="content"><a href="https://sagecell.sagemath.org/" target="_blank">https://sagecell.sagemath.org/</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2025-09-07T19:55:58.387000+00:00</span>
      <div class="content">ah no this <a href="https://github.com/keeganryan/flatter" target="_blank">https://github.com/keeganryan/flatter</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2025-09-07T19:06:01.542000+00:00</span>
      <div class="content"># wjaaaaaaat writeups (💀)

## leaky-rsa(-revenge)

I accidentally left a debug print the first time. W.

||```md
It is similar to the LSB oracle attack.

<a href="https://crypto.stackexchange.com/questions/11053/rsa-least-significant-bit-oracle-attack" target="_blank">https://crypto.stackexchange.com/questions/11053/rsa-least-significant-bit-oracle-attack</a>

In that attack, we send `pow(2, e*i, n) * c` for decryption and get back `((pow(2, i, n) * m) % n) % 2`. Note that `(pow(2, i+1, n) * m) % n` is `2 * ((pow(2, i, n) * m) % n)` minus `0` or `n`, depending on if `(pow(2, i, n) * m) % n` is greater than or less than `n/2`. So, comparing `((pow(2, i, n) * m) % n) % 2` and `((pow(2, i+1, n) * m) % n) % 2` gives us the MSB of `pow(2, i, n) * m`.

In this slightly modified version, we get a random one of the lower four bits. First, we try instances until we get an `n` that is -1 mod 16. Now, say we get the third LSB (index 2, fours place). We can send over `pow(2, e*(i+3), n) * c` and get back `((8 * pow(2, i, n) * m) % n) &amp; 4`. Note that `((8 * pow(2, i, n) * m) % n) &amp; 4 == int((((8 * pow(2, i, n) * m) % n) % 8) &gt;= 4)` and `((8 * pow(2, i, n) * m) % n) % 8` is `(0 - n * ((8 * pow(2, i, n) * m) // n)) % 8 == ((8 * pow(2, i, n) * m) // n) % 8`. Note that this value tells us which of the intervals `[0, n/8)`, ..., `[7*n/8, n)` that `pow(2, i, n) * m` is in, but we only get the MSB of it (from the `&gt;= 4` or `&amp; 4`) so we basically get one MSG of `pow(2, i, n) * m`. Repeating this will allow us to obtain all of `m`.
```||

## clcg

This is a bit shorter. I'm not sure / too lazy to explain it better...... 💀
|| Note that if `x1 = a*x0 + c` then `x1 + c/(a-1) = a*x0 + ac/(a-1) = a(x0 + c/(a-1))` so `xi = C*a**i - c/(a-1)`. If we add up 8 LCGs, it will be of the form `sum(Cj*aj**i for j) - D`, and taking the partial differences gets rid of `D`. We now note that this satisfies the linear recurrence whose characteristic polynomial is `prod(x - aj for j)`. We use this recurrence to build a lattice that will be `0` mod `p` when multiplied by the vector of true differences between state sums. ||</div>
    </div>
    <div class="message">
      <span class="timestamp">2025-09-03T10:59:56.613000+00:00</span>
      <div class="content"><a href="https://tenor.com/view/animation-cartoons-toons-reaction-gifs-family-guy-gif-14827637" target="_blank">https://tenor.com/view/animation-cartoons-toons-reaction-gifs-family-guy-gif-14827637</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2025-09-02T09:20:25.719000+00:00</span>
      <div class="content"><a href="https://tenor.com/view/chess-blunder-hikaru-wtf-gif-3171073262309786818" target="_blank">https://tenor.com/view/chess-blunder-hikaru-wtf-gif-3171073262309786818</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2025-09-02T09:20:13.579000+00:00</span>
      <div class="content"><a href="https://tenor.com/view/midnight-the-cat-stopped-working-midnight-the-cat-cat-cat-meme-funny-cat-gif-81113296414293415" target="_blank">https://tenor.com/view/midnight-the-cat-stopped-working-midnight-the-cat-cat-cat-meme-funny-cat-gif-81113296414293415</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2025-05-01T23:32:00.583000+00:00</span>
      <div class="content"><a href="https://zayn.id.vn/posts/2025/2025-01-24-imaginary-ctf-round-53/" target="_blank">https://zayn.id.vn/posts/2025/2025-01-24-imaginary-ctf-round-53/</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2025-05-01T21:32:49.260000+00:00</span>
      <div class="content">call of duty uses fnv to hash the variable names in their binary and u can use LLL to crack the short enough ones!

<a href="https://gitlab.com/-/snippets/4839503" target="_blank">https://gitlab.com/-/snippets/4839503</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2025-05-01T20:50:12.459000+00:00</span>
      <div class="content">Theres also this thingy <a href="https://github.com/Nico-Posada/fnv-hash-cracking" target="_blank">https://github.com/Nico-Posada/fnv-hash-cracking</a> which I think works the same way as the intended but I never read through it</div>
    </div>
    <div class="message">
      <span class="timestamp">2025-04-23T09:31:08.070000+00:00</span>
      <div class="content"><a href="https://cryptohack.org/challenges/post-quantum/" target="_blank">https://cryptohack.org/challenges/post-quantum/</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2025-04-15T17:33:39.109000+00:00</span>
      <div class="content"><a href="https://cryptoisnotcryptocurrency.com/" target="_blank">https://cryptoisnotcryptocurrency.com/</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2025-03-08T09:55:24.429000+00:00</span>
      <div class="content">I started a new project  called liveexploit (Exploit development toolkit). Check it out friends [<a href="https://github.com/livepwn/liveexploit]." target="_blank">https://github.com/livepwn/liveexploit].</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2025-01-23T01:59:51.076000+00:00</span>
      <div class="content"><a href="https://github.com/quasar098/ictf-archive" target="_blank">https://github.com/quasar098/ictf-archive</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2024-12-25T02:48:59.292000+00:00</span>
      <div class="content"><a href="https://imaginaryctf.org/ArchivedChallenges" target="_blank">https://imaginaryctf.org/ArchivedChallenges</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2024-12-21T16:46:10.873000+00:00</span>
      <div class="content"><a href="https://cybersharing.net/s/2fbb9a627c30b26f425d8d92547f889e" target="_blank">https://cybersharing.net/s/2fbb9a627c30b26f425d8d92547f889e</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2024-12-20T00:11:03.099000+00:00</span>
      <div class="content">&lt;@1273797170713329716&gt; here's the link in the meantime sorry about that  <a href="https://cybersharing.net/s/499534af8cedbe1f7efcea676d219002" target="_blank">https://cybersharing.net/s/499534af8cedbe1f7efcea676d219002</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2024-12-07T17:17:20.610000+00:00</span>
      <div class="content"><a href="https://discord.com/channels/732308165265326080/762690967093379082/1314692852030115902" target="_blank">https://discord.com/channels/732308165265326080/762690967093379082/1314692852030115902</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2024-11-09T03:47:19.027000+00:00</span>
      <div class="content"><a href="https://www.reddit.com/r/securityCTF/comments/1gmv139/help_with_ctf_crypto/" target="_blank">https://www.reddit.com/r/securityCTF/comments/1gmv139/help_with_ctf_crypto/</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2024-10-27T01:36:22.095000+00:00</span>
      <div class="content">Also consider <a href="https://cryptohack.org" target="_blank">https://cryptohack.org</a> 😉</div>
    </div>
    <div class="message">
      <span class="timestamp">2024-10-05T05:22:31.572000+00:00</span>
      <div class="content">always available on <a href="https://imaginaryctf.org/ArchivedChallenges" target="_blank">https://imaginaryctf.org/ArchivedChallenges</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2024-07-22T03:40:32.587000+00:00</span>
      <div class="content"><a href="https://discord.com/channels/732308165265326080/1263871130167545947/1264668239300923393" target="_blank">https://discord.com/channels/732308165265326080/1263871130167545947/1264668239300923393</a>
<a href="https://discord.com/channels/732308165265326080/1263871130167545947/1264663849982890035" target="_blank">https://discord.com/channels/732308165265326080/1263871130167545947/1264663849982890035</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2024-07-21T23:07:32.399000+00:00</span>
      <div class="content"><a href="https://github.com/maximmasiutin/rsa-common-modulus/blob/main/rsa-common-modulus.py" target="_blank">https://github.com/maximmasiutin/rsa-common-modulus/blob/main/rsa-common-modulus.py</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2024-07-21T22:02:51.312000+00:00</span>
      <div class="content"><a href="https://yun.ng/c/ctf/2024-ictf/crypto/integrity" target="_blank">https://yun.ng/c/ctf/2024-ictf/crypto/integrity</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2024-07-21T20:48:52.141000+00:00</span>
      <div class="content"><a href="https://yun.ng/c/ctf/2024-ictf/crypto/tango" target="_blank">https://yun.ng/c/ctf/2024-ictf/crypto/tango</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2024-07-21T19:51:16.809000+00:00</span>
      <div class="content">writeups for my own challenges: <a href="https://github.com/maple3142/My-CTF-Challenges#imaginaryctf-2024" target="_blank">https://github.com/maple3142/My-CTF-Challenges#imaginaryctf-2024</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2024-07-21T19:48:25.881000+00:00</span>
      <div class="content"><a href="https://discord.com/channels/732308165265326080/732318949617696828/1264665572193341591" target="_blank">https://discord.com/channels/732308165265326080/732318949617696828/1264665572193341591</a>

here is one mini writeup</div>
    </div>
    <div class="message">
      <span class="timestamp">2024-07-21T19:45:41.032000+00:00</span>
      <div class="content">16 bytes is trivial, even 24 bytes is no issue according to this: <a href="https://discord.com/channels/732308165265326080/732318949617696828/1264665572193341591" target="_blank">https://discord.com/channels/732308165265326080/732318949617696828/1264665572193341591</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2024-07-21T19:41:16.714000+00:00</span>
      <div class="content">any `lcasm` writeups? i was able to write 16 bytes of shellcode using z3 but i just couldn't get the 20+ i needed for the most compact execve(/bin/sh) i had - here is a BROKEN attempt ⚠️ <a href="https://gist.github.com/dmur1/6692f0337df700a119839b3c5bee4d5b" target="_blank">https://gist.github.com/dmur1/6692f0337df700a119839b3c5bee4d5b</a></div>
    </div>
    <div class="message">
      <span class="timestamp">2024-07-21T19:11:29.427000+00:00</span>
      <div class="content"><a href="https://crypto.stackexchange.com/questions/1614/rsa-cracking-the-same-message-is-sent-to-two-different-people-problem" target="_blank">https://crypto.stackexchange.com/questions/1614/rsa-cracking-the-same-message-is-sent-to-two-different-people-problem</a></div>
    </div>
  </div>
  <h3>Gemini Chat Summary</h3>
  <section id="summary">
```html
<div style="font-family: Arial, sans-serif; line-height: 1.6; color: #333; border: 1px solid #ddd; padding: 20px; border-radius: 8px; background-color: #f9f9f9;">

    <h2 style="border-bottom: 2px solid #eee; padding-bottom: 10px; color: #2c3e50;">Comprehensive Analysis of a Technical Cryptography Discussion</h2>

    <p>This conversation captures a dense, expert-level exchange on advanced cryptography, focusing on lattice-based attacks, solutions to Capture The Flag (CTF) challenges, and the sharing of valuable tools and resources. The participants discuss theoretical concepts, practical implementations in Python, and detailed methodologies for breaking cryptographic schemes.</p>

    <section>
        <h3 style="color: #34495e;">1. Advanced Lattice-Based Cryptanalysis</h3>
        <p>A core topic is the application of lattice reduction algorithms, specifically LLL, to solve cryptographic problems. The discussion highlights two primary lattice constructions:</p>
        <ul>
            <li>
                <strong>PACD Lattice Attack:</strong> A standard Approximate Common Divisor (ACD) problem can be approached using a specific block matrix construction. The provided Python snippet demonstrates how to form this matrix before applying the LLL algorithm.
                <pre style="background-color: #2d2d2d; color: #f1f1f1; padding: 15px; border-radius: 5px; overflow-x: auto;"><code>
M = block_matrix([
    [1, zero_vector(t).row()],
    [vector(x).column(), identity_matrix(t)*m]
]).T.LLL()
                </code></pre>
            </li>
            <li>
                <strong>Improved SDA Lattice for ACD-CRT:</strong> A more advanced technique is referenced from an e-print paper (<a href="https://eprint.iacr.org/2024/1125.pdf" target="_blank">iacr.org/2024/1125.pdf</a>). The `AGCD` function is presented as a method to leverage this lattice to find a factor of a semiprime number `N`. The strategy involves two calls to the function to fully split the modulus `mg`.
                <pre style="background-color: #2d2d2d; color: #f1f1f1; padding: 15px; border-radius: 5px; overflow-x: auto;"><code>
# Improved SDA lattice for ACD-CRT
def AGCD(x, N, rho):
    t = len(x)
    M = block_matrix([
        [2^rho, vector(x).row()],
        [zero_vector(t).column(), identity_matrix(t)*N]
    ]).LLL()
    for r in M.rows():
        g = gcd(abs(r[0]), N)
        if 1 &lt; g &lt; N:
            return N//g

# Usage to split a semiprime
mg = AGCD(nums, m, rho)
p1 = AGCD(nums, mg, rho)
p2 = mg // p1
                </code></pre>
            </li>
        </ul>
        <p>The conversation also touches on using LLL to crack short-enough FNV (Fowler-Noll-Vo) hashes, a technique reportedly used for variable names in game binaries like Call of Duty.</p>
    </section>

    <section>
        <h3 style="color: #34495e;">2. CTF Challenge Write-ups & Methodologies</h3>
        <p>Two specific CTF challenges are broken down in detail:</p>
        <blockquote style="border-left: 4px solid #16a085; padding-left: 15px; margin: 15px 0; background-color: #fff;">
            <h4 style="margin-top: 0; color: #16a085;">leaky-rsa(-revenge)</h4>
            <p>This challenge involves a modified <strong>RSA LSB Oracle Attack</strong>. Instead of the true least significant bit, the oracle returns a random one of the lower four bits. The solution involves:</p>
            <ol>
                <li>Finding an instance where the modulus `n` is congruent to -1 mod 16.</li>
                <li>Sending crafted ciphertexts, like <code>pow(2, e*(i+3), n) * c</code>, to probe specific bit positions.</li>
                <li>The returned bit (e.g., the 4's place) reveals information about which octant of the modulus `[0, n/8), ..., [7n/8, n)` the value <code>pow(2, i, n) * m</code> falls into.</li>
                <li>This effectively provides one most significant bit (MSB) of information, allowing the attacker to narrow down the range of the message `m` and eventually recover it completely.</li>
            </ol>
        </blockquote>
        <blockquote style="border-left: 4px solid #2980b9; padding-left: 15px; margin: 15px 0; background-color: #fff;">
            <h4 style="margin-top: 0; color: #2980b9;">clcg</h4>
            <p>This problem concerns a composite generator formed by summing 8 Linear Congruential Generators (LCGs). The key insight is:</p>
            <ol>
                <li>The output sequence, <code>sum(Cj*aj**i for j) - D</code>, can be simplified by taking partial differences, which eliminates the constant term `D`.</li>
                <li>The resulting sequence of differences satisfies a linear recurrence whose characteristic polynomial is <code>prod(x - aj for j)</code>.</li>
                <li>This recurrence is used to construct a lattice. When multiplied by the vector of true state differences, the result is 0 modulo `p`, revealing the hidden parameters.</li>
            </ol>
        </blockquote>
        <p>A separate discussion mentions the <code>lcasm</code> challenge, where the difficulty was writing shellcode compact enough (under 20 bytes) to fit within the allowed space for a call to <code>execve(/bin/sh)</code>.</p>
    </section>

    <section>
        <h3 style="color: #34495e;">3. Shared Resources, Tools, and Links</h3>
        <p>A vast collection of links was shared, covering educational materials, code repositories, and further reading. Key resources include:</p>
        <ul>
            <li><strong>Books & Learning Platforms:</strong>
                <ul>
                    <li><a href="https://nostarch.com/serious-cryptography-2nd-edition" target="_blank">Serious Cryptography, 2nd Edition</a></li>
                    <li><a href="https://cryptohack.org" target="_blank">CryptoHack</a> & <a href="https://imaginaryctf.org/ArchivedChallenges" target="_blank">ImaginaryCTF Archives</a></li>
                </ul>
            </li>
            <li><strong>Code & Toolkits:</strong>
                <ul>
                    <li><a href="https://github.com/keeganryan/flatter" target="_blank">flatter</a>: A GitHub repository related to the lattice discussion.</li>
                    <li><a href="https://github.com/livepwn/liveexploit" target="_blank">liveexploit</a>: A newly announced exploit development toolkit.</li>
                    <li><a href="https://github.com/Nico-Posada/fnv-hash-cracking" target="_blank">fnv-hash-cracking</a>: A tool for cracking FNV hashes.</li>
                    <li><a href="https://github.com/maximmasiutin/rsa-common-modulus/blob/main/rsa-common-modulus.py" target="_blank">rsa-common-modulus.py</a>: An implementation of the RSA common modulus attack.</li>
                </ul>
            </li>
            <li><strong>Write-ups & Technical Articles:</strong>
                <ul>
                    <li>StackExchange and personal blogs (<a href="https://yun.ng/c/ctf/2024-ictf/crypto/integrity" target="_blank">yun.ng</a>) with solutions for various CTF crypto challenges (Integrity, Tango).</li>
                    <li>A collection of personal CTF challenge write-ups on <a href="https://github.com/maple3142/My-CTF-Challenges#imaginaryctf-2024" target="_blank">GitHub</a>.</li>
                </ul>
            </li>
        </ul>
    </section>
</div>
```
  </section>
  <script>
    // Force chat to start at the bottom (newest messages)
    const chat = document.getElementById("chat");
    chat.scrollTop = chat.scrollHeight;
  </script>
</body>
</html>
